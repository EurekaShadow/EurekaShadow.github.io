---
slug: AboutPic
title: å›¾ç‰‡è½¬æ¢
authors: eurekaX
tags: [ffmpeg,å›¾ç‰‡]
---

import { Highlight, Keyword, Light, B1, B2, B3, BH3, B3W, MyColor} from '@site/src/components/ForMDX';
import CardImg from '@site/src/components/CardImg';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## <B2> [process-images.js](https://github.com/EurekaShadow/EurekaShadow.github.io/blob/master/scripts/process-images.js ) è„šæœ¬</B2>

æœ¬æ–‡å°†ä»‹ç» `process-images.js` è„šæœ¬ä»¥åŠåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚

<!-- truncate -->

## ğŸ¯ åŠŸèƒ½
- æ ¼å¼è½¬æ¢ï¼šå°†PNGã€GIFã€BMPã€WebPç­‰æ ¼å¼è½¬æ¢ä¸ºJPG
- æ™ºèƒ½å‹ç¼©ï¼šè‡ªåŠ¨ä¼˜åŒ–JPGå›¾ç‰‡å¤§å°ï¼Œä¿æŒè´¨é‡å¹³è¡¡
- æ‰¹é‡é‡å‘½åï¼šæŒ‰æŒ‡å®šå‰ç¼€è‡ªåŠ¨ç¼–å·é‡å‘½åå›¾ç‰‡
- å¤„ç†ç»Ÿè®¡ï¼šæ˜¾ç¤ºå‹ç¼©ç‡ã€å¤„ç†æ—¶é—´ç­‰è¯¦ç»†ä¿¡æ¯
- æ—¥å¿—è®°å½•ï¼šå¯é€‰ç”Ÿæˆè¯¦ç»†å¤„ç†æ—¥å¿—

## ğŸ“ ç”¨é€”
é€‚ç”¨äºç½‘ç«™å›¾ç‰‡ä¼˜åŒ–ï¼Œç‰¹åˆ«é€‚åˆDocusaurusç­‰é™æ€ç½‘ç«™é¡¹ç›®ï¼Œå¸®åŠ©ï¼š

- å‡å°å›¾ç‰‡æ–‡ä»¶å¤§å°ï¼Œæå‡ç½‘é¡µåŠ è½½é€Ÿåº¦
- ç»Ÿä¸€å›¾ç‰‡æ ¼å¼ï¼Œä¾¿äºç®¡ç†
- è§„èŒƒå›¾ç‰‡å‘½åï¼Œé¿å…é‡å¤æ–‡ä»¶å

## â–¶ï¸ ç”¨æ³•

<Tabs>

  <TabItem value="node" label="node">
```bash title="bash"
# è¿è¡Œè„šæœ¬
node scripts/process-images.js
# æŒ‰æç¤ºæ“ä½œï¼š
# 1. é€‰æ‹©è¦å¤„ç†çš„å›¾ç‰‡ç›®å½•
# 2. è¾“å…¥æ–‡ä»¶åå‰ç¼€ï¼ˆç›´æ¥å›è½¦è·³è¿‡é‡å‘½åï¼‰
# 3. é€‰æ‹©æ˜¯å¦ç”Ÿæˆæ—¥å¿—æ–‡ä»¶
# 4. ç¡®è®¤å¼€å§‹å¤„ç†
```
  </TabItem>

  <TabItem value="yarn" label="yarn">
```bash title="bash"
yarn process-img
```
  </TabItem>

</Tabs>

## âš ï¸ æ³¨æ„äº‹é¡¹
- éœ€è¦ç³»ç»Ÿå·²å®‰è£…ffmpeg
- é»˜è®¤å¤„ç† static/img ç›®å½•ä¸‹çš„å›¾ç‰‡
- åŸæ–‡ä»¶ä¼šè¢«åˆ é™¤ï¼Œå»ºè®®å…ˆå¤‡ä»½é‡è¦å›¾ç‰‡
- æ—¥å¿—æ–‡ä»¶é»˜è®¤ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ logs/ æ–‡ä»¶å¤¹
- å¤„ç†å¤§å›¾ç‰‡æˆ–å¤§é‡å›¾ç‰‡æ—¶éœ€è¦è¾ƒé•¿æ—¶é—´
- è„šæœ¬ä¼šè‡ªåŠ¨è·³è¿‡å·²æŒ‰å‘½åè§„åˆ™å¤„ç†çš„æ–‡ä»¶

## ğŸ“ ç›®å½•ç»“æ„
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ static/img/          # å›¾ç‰‡å¤„ç†ç›®å½•
â”‚   â”œâ”€â”€ Blog/           # å­ç›®å½•å›¾ç‰‡
â”‚   â””â”€â”€ *.png/jpgç­‰     # å¾…å¤„ç†å›¾ç‰‡
â”œâ”€â”€ logs/               # æ—¥å¿—æ–‡ä»¶ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€â”€ process-images.js   # è„šæœ¬æ–‡ä»¶
```
---

## é”™è¯¯å°†å›¾ç‰‡è¿›è¡Œè½¬æ¢å‹ç¼©é‡å‘½ååï¼Œæƒ³è¦å¤åŸ

### 1. æ¢å¤å·²è·Ÿè¸ªçš„æ–‡ä»¶åˆ°ä¹‹å‰çŠ¶æ€
```bash
git checkout HEAD~1 -- "D:/Docusaurus/test-site/static/img/Blog/"
```
### 2. æŸ¥çœ‹æœªè·Ÿè¸ªçš„æ–‡ä»¶
```bash
git ls-files --others "D:/Docusaurus/test-site/static/img/Blog/"
```

### 3. æ¸…ç†æœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼ˆé¢„è§ˆï¼‰
```bash
git clean -n "D:/Docusaurus/test-site/static/img/Blog/"
```

### 4. ç¡®è®¤æ— è¯¯åæ‰§è¡Œæ¸…ç†
```bash
git clean -f "D:/Docusaurus/test-site/static/img/Blog/"
```

### 5. æŸ¥çœ‹æœ€ç»ˆçŠ¶æ€
```bash
git status
```

## é¢„é˜²æªæ–½
åœ¨è¿è¡Œå›¾ç‰‡å¤„ç†è„šæœ¬å‰ï¼š
```
# 1. æäº¤å½“å‰çŠ¶æ€
git add .
git commit -m "Before running image processing script"

# 2. åˆ›å»ºå¤‡ä»½åˆ†æ”¯
git checkout -b backup-before-processing

# 3. å›åˆ°ä¸»åˆ†æ”¯è¿›è¡Œå¤„ç†
git checkout main

# è¿è¡Œè„šæœ¬...
# node process-images.js

# å¦‚æœä¸æ»¡æ„ç»“æœï¼Œå¯ä»¥è½»æ¾å›åˆ°å¤‡ä»½çŠ¶æ€ï¼š
# git reset --hard backup-before-processing
```

## å‹ç¼© gif å›¾ç‰‡æ€è·¯
> åç»­åº”æŠŠ gif è½¬ jpg çš„ä»£ç åˆ å»
### äº¤äº’æµç¨‹è®¾è®¡
```
=== å›¾ç‰‡å¤„ç†è„šæœ¬ ===
è¯·é€‰æ‹©å¤„ç†ç±»å‹ï¼š
1. æ™®é€šå›¾ç‰‡å¤„ç†ï¼ˆPNG/JPGç­‰æ ¼å¼è½¬æ¢å’Œå‹ç¼©ï¼‰
2. GIFå›¾ç‰‡ä¼˜åŒ–

è¯·è¾“å…¥é€‰é¡¹ç¼–å·:

# å¦‚æœé€‰æ‹©1ï¼šè¿›å…¥åŸæœ‰æµç¨‹
# å¦‚æœé€‰æ‹©2ï¼šè¿›å…¥GIFä¸“ç”¨æµç¨‹
```

### GIFå¤„ç†æµç¨‹
```
è¯·é€‰æ‹©è¦å¤„ç†çš„GIFç›®å½•:
1. ~/static/img/xxxç›®å½• (åŒ…å«Nä¸ªGIFæ–‡ä»¶)
...

è¯·é€‰æ‹©GIFå¤„ç†é€‰é¡¹ï¼š
1. ä»…è½¬æ¢æ ¼å¼ï¼ˆPNG/JPGï¼‰
2. è½»å¾®å‹ç¼©ï¼ˆå‡å°20-30%ï¼Œä¿æŒè´¨é‡ï¼‰
3. ä¸­åº¦å‹ç¼©ï¼ˆå‡å°50-70%ï¼Œé€‚åº¦é™ä½è´¨é‡ï¼‰
4. é‡åº¦å‹ç¼©ï¼ˆå‡å°80%+ï¼Œæ˜¾è‘—é™ä½è´¨é‡ï¼‰
5. è‡ªå®šä¹‰å‹ç¼©

æ˜¯å¦éœ€è¦é‡å‘½åå¤„ç†åçš„æ–‡ä»¶ï¼Ÿ(Y/N):
```

### ffmpegå‘½ä»¤ç¤ºä¾‹
```bash title="bash"
# è½»å¾®å‹ç¼©
ffmpeg -i input.gif -filter_complex "[0:v] split [a][b];[a] palettegen=reserve_transparent=on:transparency_color=ffffff [p];[b][p] paletteuse" output.gif

# ä¸­åº¦å‹ç¼©
ffmpeg -i input.gif -filter_complex "[0:v] fps=15,scale=iw/2:-1 [a];[a] split [b][c];[b] palettegen=reserve_transparent=on:transparency_color=ffffff [p];[c][p] paletteuse" output.gif

# é‡åº¦å‹ç¼©
ffmpeg -i input.gif -filter_complex "[0:v] fps=10,scale=iw/3:-1 [a];[a] split [b][c];[b] palettegen=reserve_transparent=on:transparency_color=ffffff [p];[c][p] paletteuse" -colors 32 output.gif
```

