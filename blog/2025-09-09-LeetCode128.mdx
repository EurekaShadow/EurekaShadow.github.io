---
slug: LeetCode128
title: æœ€é•¿è¿ç»­åºåˆ—
authors: eurekaX
tags: [å¹¶æŸ¥é›†,æ•°ç»„,å“ˆå¸Œè¡¨]
---
import { Highlight, Keyword, Light, B1, B2, B3, BH3, B3W, MyColor} from '@site/src/components/ForMDX';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


### <B2>[åŠ›æ‰£é¢è¯•ç»å…¸â€”â€”128é¢˜](https://leetcode.cn/problems/longest-consecutive-sequence/description/?envType=study-plan-v2&envId=top-interview-150 "åŠ›æ‰£")</B2>

<!-- truncate -->


### ğŸ’¡ å‚è€ƒä»£ç ï¼š

<Tabs>

  <TabItem value="AI" label="AI">
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// å“ˆå¸Œè¡¨èŠ‚ç‚¹ç»“æ„
typedef struct HashNode {
    int key;
    int value;  // ç”¨äºæ ‡è®°æ˜¯å¦å·²è®¿é—®
    UT_hash_handle hh;  // uthashæ‰€éœ€å¥æŸ„
} HashNode;

/**
 * å¯»æ‰¾æœ€é•¿è¿ç»­åºåˆ—é•¿åº¦
 * @param nums æ•´æ•°æ•°ç»„
 * @param numsSize æ•°ç»„é•¿åº¦
 * @return æœ€é•¿è¿ç»­åºåˆ—çš„é•¿åº¦
 */
int longestConsecutive(int* nums, int numsSize) {
    // è¾¹ç•Œæ¡ä»¶å¤„ç†ï¼šç©ºæ•°ç»„ç›´æ¥è¿”å›0
    if (numsSize == 0) {
        return 0;
    }

    HashNode* hashTable = NULL;  // åˆå§‹åŒ–å“ˆå¸Œè¡¨
    HashNode* tmp;
    
    // ç¬¬ä¸€æ­¥ï¼šå°†æ‰€æœ‰å…ƒç´ å­˜å…¥å“ˆå¸Œè¡¨ï¼Œå»é‡å¹¶å»ºç«‹å¿«é€ŸæŸ¥æ‰¾ç»“æ„
    for (int i = 0; i < numsSize; i++) {
        // æŸ¥æ‰¾å½“å‰å…ƒç´ æ˜¯å¦å·²å­˜åœ¨äºå“ˆå¸Œè¡¨ä¸­
        HASH_FIND_INT(hashTable, &nums[i], tmp);
        if (tmp == NULL) {
            // è‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°èŠ‚ç‚¹å¹¶æ’å…¥å“ˆå¸Œè¡¨
            tmp = (HashNode*)malloc(sizeof(HashNode));
            tmp->key = nums[i];
            tmp->value = 0;  // 0è¡¨ç¤ºæœªè®¿é—®è¿‡
            HASH_ADD_INT(hashTable, key, tmp);
        }
    }
    
    int maxLength = 0;  // è®°å½•æœ€é•¿è¿ç»­åºåˆ—é•¿åº¦
    
    // éå†å“ˆå¸Œè¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ 
    HashNode* current;
    HashNode* tmpIter;
    HASH_ITER(hh, hashTable, current, tmpIter) {
        // åªæœ‰å½“current->key-1ä¸å­˜åœ¨æ—¶ï¼Œcurrent->keyæ‰æ˜¯æŸä¸ªè¿ç»­åºåˆ—çš„èµ·ç‚¹
        HASH_FIND_INT(hashTable, &(current->key - 1), tmp);
        if (tmp == NULL) {
            // æ‰¾åˆ°åºåˆ—èµ·ç‚¹ï¼Œä»è¯¥ç‚¹å¼€å§‹å‘åæŸ¥æ‰¾è¿ç»­å…ƒç´ 
            int currentNum = current->key;
            int currentLength = 1;
            
            // å‘åæŸ¥æ‰¾è¿ç»­å…ƒç´ 
            HASH_FIND_INT(hashTable, &(currentNum + 1), tmp);
            while (tmp != NULL) {
                tmp->value = 1;  // æ ‡è®°ä¸ºå·²è®¿é—®
                currentLength++;
                currentNum++;
                HASH_FIND_INT(hashTable, &(currentNum + 1), tmp);
            }
            
            // æ›´æ–°æœ€å¤§é•¿åº¦
            if (currentLength > maxLength) {
                maxLength = currentLength;
            }
        }
    }
    
    // æ¸…ç†å“ˆå¸Œè¡¨å†…å­˜
    HashNode* el;
    HashNode* tmpEl;
    HASH_ITER(hh, hashTable, el, tmpEl) {
        HASH_DEL(hashTable, el);
        free(el);
    }
    
    return maxLength;
}

// æµ‹è¯•å‡½æ•°
int main() {
    // æµ‹è¯•ç”¨ä¾‹1
    int nums1[] = {100, 4, 200, 1, 3, 2};
    int size1 = sizeof(nums1)/sizeof(nums1[0]);
    printf("Test 1: %d\n", longestConsecutive(nums1, size1));  // é¢„æœŸè¾“å‡º: 4
    
    // æµ‹è¯•ç”¨ä¾‹2
    int nums2[] = {0, 3, 7, 2, 5, 8, 4, 6, 0, 1};
    int size2 = sizeof(nums2)/sizeof(nums2[0]);
    printf("Test 2: %d\n", longestConsecutive(nums2, size2));  // é¢„æœŸè¾“å‡º: 9
    
    // æµ‹è¯•ç”¨ä¾‹3
    int nums3[] = {1, 0, 1, 2};
    int size3 = sizeof(nums3)/sizeof(nums3[0]);
    printf("Test 3: %d\n", longestConsecutive(nums3, size3));  // é¢„æœŸè¾“å‡º: 3
    
    return 0;
}
```
  </TabItem>

<TabItem value="OTHER" label="OTHER">
```c
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <stdbool.h>

#define EMPTY INT_MAX   // å“ˆå¸Œè¡¨ç©ºä½æ ‡è®°

// ====================== å“ˆå¸Œè¡¨å®ç° ======================
typedef struct {
    int *keys;
    int size;
} HashSet;

HashSet* createHashSet(int capacity) {
    HashSet* set = (HashSet*)malloc(sizeof(HashSet));
    set->size = capacity * 2;
    set->keys = (int*)malloc(sizeof(int) * set->size);
    for (int i = 0; i < set->size; i++) set->keys[i] = EMPTY;
    return set;
}

unsigned int hash(HashSet* set, int key) {
    return ((unsigned int)key) % set->size;
}

void insert(HashSet* set, int key) {
    unsigned int idx = hash(set, key);
    while (set->keys[idx] != EMPTY && set->keys[idx] != key) {
        idx = (idx + 1) % set->size;
    }
    set->keys[idx] = key;
}

bool contains(HashSet* set, int key) {
    unsigned int idx = hash(set, key);
    int start = idx;
    while (set->keys[idx] != EMPTY) {
        if (set->keys[idx] == key) return true;
        idx = (idx + 1) % set->size;
        if (idx == start) break;
    }
    return false;
}

void freeHashSet(HashSet* set) {
    free(set->keys);
    free(set);
}

// ====================== ä¸»é€»è¾‘ ======================
int longestConsecutive(int* nums, int n) {
    if (n == 0) return 0;

    int mn = INT_MAX, mx = INT_MIN;
    for (int i = 0; i < n; i++) {
        if (nums[i] < mn) mn = nums[i];
        if (nums[i] > mx) mx = nums[i];
    }

    long long range = (long long)mx - (long long)mn + 1;

    // ---------- å°èŒƒå›´ï¼šç”¨ä½å›¾ ----------
    if (range <= 10000000) { // 1000ä¸‡å¯æ¥å—
        char *bitmap = (char*)calloc(range, sizeof(char));
        for (int i = 0; i < n; i++) {
            bitmap[nums[i] - mn] = 1;
        }

        int longest = 0, curr = 0;
        for (long long i = 0; i < range; i++) {
            if (bitmap[i]) {
                curr++;
                if (curr > longest) longest = curr;
            } else {
                curr = 0;
            }
        }

        free(bitmap);
        return longest;
    }

    // ---------- å¤§èŒƒå›´ï¼šç”¨å“ˆå¸Œè¡¨ ----------
    HashSet* set = createHashSet(n);
    for (int i = 0; i < n; i++) insert(set, nums[i]);

    int longest = 0;
    for (int i = 0; i < n; i++) {
        int num = nums[i];
        if (!contains(set, num - 1)) { // åªä»èµ·ç‚¹æ‰©å±•
            int curr = num, len = 1;
            while (contains(set, curr + 1)) {
                curr++;
                len++;
            }
            if (len > longest) longest = len;
        }
    }

    freeHashSet(set);
    return longest;
}

// ====================== æµ‹è¯• ======================
// int main() {
//     int nums1[] = {100, 4, 200, 1, 3, 2};
//     int n1 = sizeof(nums1) / sizeof(nums1[0]);
//     printf("%d\n", longestConsecutive(nums1, n1)); // 4

//     int nums2[] = {0,1,2,4,8,5,6,7,9,3,55,88,77,99,999999999};
//     int n2 = sizeof(nums2) / sizeof(nums2[0]);
//     printf("%d\n", longestConsecutive(nums2, n2)); // 10 âœ…

//     return 0;
// }
```
  </TabItem>

</Tabs>



### ğŸ“– æ€»ç»“ï¼š

<details>
<summary>ç‚¹å‡»å±•å¼€é¢˜ç›®æ€»ç»“</summary>
# ğŸ¤” æœ€é•¿è¿ç»­åºåˆ—

---

## 1ï¸âƒ£ é¢˜ç›®æ ¸å¿ƒä¿¡æ¯

ğŸ¯ **åŠŸèƒ½æè¿°**ï¼šç»™å®šä¸€ä¸ªæœªæ’åºçš„æ•´æ•°æ•°ç»„ï¼Œæ‰¾å‡ºæ•°å­—è¿ç»­çš„æœ€é•¿åºåˆ—ï¼ˆä¸è¦æ±‚åºåˆ—å…ƒç´ åœ¨åŸæ•°ç»„ä¸­è¿ç»­ï¼‰çš„é•¿åº¦ã€‚

ğŸ“¥ **è¾“å…¥è¾“å‡º**ï¼š
- **è¾“å…¥**ï¼š
  - `nums`: æ•´æ•°æ•°ç»„ï¼ŒåŒ…å«å¾…å¤„ç†çš„æ•°å­—åºåˆ—
  - `numsSize`: æ•°ç»„é•¿åº¦ï¼Œè¡¨ç¤ºæ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°
- **è¾“å‡º**ï¼šè¿”å›æœ€é•¿è¿ç»­æ•°å­—åºåˆ—çš„é•¿åº¦

---

## 2ï¸âƒ£ å®ç°åŸç†

ğŸ’¡ **æ ¸å¿ƒæ€è·¯**ï¼šä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨æ‰€æœ‰æ•°å­—ï¼Œç„¶ååªä»è¿ç»­åºåˆ—çš„èµ·ç‚¹å¼€å§‹è®¡æ•°ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚

ğŸ“‹ **å®ç°æ­¥éª¤**ï¼š
1. éå†æ•°ç»„ï¼Œå°†æ‰€æœ‰å…ƒç´ å­˜å…¥å“ˆå¸Œè¡¨å®ç°å»é‡å’Œå¿«é€ŸæŸ¥æ‰¾
2. å†æ¬¡éå†å“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ ï¼Œåˆ¤æ–­æ¯ä¸ªå…ƒç´ æ˜¯å¦ä¸ºè¿ç»­åºåˆ—çš„èµ·ç‚¹
3. å¯¹äºæ¯ä¸ªèµ·ç‚¹ï¼Œå‘åæŸ¥æ‰¾è¿ç»­å…ƒç´ å¹¶è®¡ç®—åºåˆ—é•¿åº¦
4. è®°å½•å¹¶æ›´æ–°æœ€é•¿åºåˆ—é•¿åº¦

---

## 3ï¸âƒ£ å…³é”®ç‚¹è§£æ

### ğŸ¯ ä»£ç æŠ€å·§
- ä½¿ç”¨UTHASHåº“å®ç°å“ˆå¸Œè¡¨åŠŸèƒ½ï¼Œæä¾›O(1)çš„æŸ¥æ‰¾æ•ˆç‡
- é€šè¿‡æ£€æŸ¥`n-1`æ˜¯å¦å­˜åœ¨æ¥ç¡®å®š`n`æ˜¯å¦ä¸ºåºåˆ—èµ·ç‚¹ï¼Œé¿å…é‡å¤è®¡ç®—
- åªå¯¹åºåˆ—èµ·ç‚¹è¿›è¡Œæ‰©å±•æœç´¢ï¼Œç¡®ä¿æ¯ä¸ªå…ƒç´ æœ€å¤šè¢«è®¿é—®ä¸¤æ¬¡
- ä½¿ç”¨`HASH_ITER`å®‰å…¨åœ°éå†å’Œåˆ é™¤å“ˆå¸Œè¡¨å…ƒç´ 

## 4ï¸âƒ£ ä½¿ç”¨åœºæ™¯

### âœ… é€‚ç”¨æƒ…å†µï¼š
- éœ€è¦åœ¨ä¸€ä¸ªæœªæ’åºæ•°ç»„ä¸­æŸ¥æ‰¾æœ€é•¿è¿ç»­æ•°å­—åºåˆ—
- æ•°æ®èŒƒå›´è¾ƒå¤§ï¼Œä¸èƒ½ä½¿ç”¨æ’åºç®—æ³•
- éœ€è¦O(n)æ—¶é—´å¤æ‚åº¦çš„è§£å†³æ–¹æ¡ˆ

### âš ï¸ å‰ææ¡ä»¶ï¼š
- æ•°ç»„å…ƒç´ ä¸ºæ•´æ•°
- å¯ä»¥ä½¿ç”¨é¢å¤–çš„O(n)ç©ºé—´
- å…è®¸ä¿®æ”¹å“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ çŠ¶æ€

## 5ï¸âƒ£ å¤æ‚åº¦åˆ†æ

- â±ï¸ æ—¶é—´å¤æ‚åº¦ï¼šO(n) - æ¯ä¸ªå…ƒç´ æœ€å¤šè¢«è®¿é—®ä¸¤æ¬¡
- ğŸ’¾ ç©ºé—´å¤æ‚åº¦ï¼šO(n) - éœ€è¦å“ˆå¸Œè¡¨å­˜å‚¨æ‰€æœ‰å…ƒç´ 

## 6ï¸âƒ£ æ³¨æ„äº‹é¡¹

### ğŸš© è¾¹ç•Œæƒ…å†µï¼š
- ç©ºæ•°ç»„ï¼šç›´æ¥è¿”å›0
- å•ä¸ªå…ƒç´ æ•°ç»„ï¼šè¿”å›1
- åŒ…å«é‡å¤å…ƒç´ ï¼šå“ˆå¸Œè¡¨è‡ªåŠ¨å»é‡å¤„ç†

### ğŸ’¥ æ˜“é”™ç‚¹ï¼š
- ä¸èƒ½å¯¹è¡¨è¾¾å¼å–åœ°å€ï¼ˆå¦‚`&(current->key - 1)`ï¼‰ï¼Œéœ€è¦å…ˆè®¡ç®—å€¼å†å–åœ°å€
- å¿˜è®°é‡Šæ”¾å“ˆå¸Œè¡¨å†…å­˜å¯¼è‡´å†…å­˜æ³„æ¼
- æ²¡æœ‰æ­£ç¡®åˆ¤æ–­åºåˆ—èµ·ç‚¹å¯¼è‡´é‡å¤è®¡ç®—

## 7ï¸âƒ£ è¡¥å……è¯´æ˜

ä»¥æ•°ç»„ `[100, 4, 200, 1, 3, 2]`ä¸ºä¾‹ï¼š
#### æ­¥éª¤1ï¼šæ„å»ºå“ˆå¸Œè¡¨
é¦–å…ˆå°†æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ å­˜å…¥å“ˆå¸Œè¡¨ï¼š
```
å“ˆå¸Œè¡¨å†…å®¹ï¼š{100, 4, 200, 1, 3, 2}
```

#### æ­¥éª¤2ï¼šéå†å“ˆå¸Œè¡¨å¯»æ‰¾åºåˆ—èµ·ç‚¹
éå†å“ˆå¸Œè¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºåºåˆ—èµ·ç‚¹ï¼š

1. **æ£€æŸ¥å…ƒç´ 100**ï¼š
   - åˆ¤æ–­99æ˜¯å¦å­˜åœ¨ â†’ ä¸å­˜åœ¨
   - æ‰€ä»¥100æ˜¯åºåˆ—èµ·ç‚¹
   - ä»100å¼€å§‹å‘åæŸ¥æ‰¾ï¼š100 â†’ æ— åç»­å…ƒç´ 
   - åºåˆ—é•¿åº¦ï¼š1

2. **æ£€æŸ¥å…ƒç´ 4**ï¼š
   - åˆ¤æ–­3æ˜¯å¦å­˜åœ¨ â†’ å­˜åœ¨
   - æ‰€ä»¥4ä¸æ˜¯åºåˆ—èµ·ç‚¹ï¼Œè·³è¿‡

3. **æ£€æŸ¥å…ƒç´ 200**ï¼š
   - åˆ¤æ–­199æ˜¯å¦å­˜åœ¨ â†’ ä¸å­˜åœ¨
   - æ‰€ä»¥200æ˜¯åºåˆ—èµ·ç‚¹
   - ä»200å¼€å§‹å‘åæŸ¥æ‰¾ï¼š200 â†’ æ— åç»­å…ƒç´ 
   - åºåˆ—é•¿åº¦ï¼š1

4. **æ£€æŸ¥å…ƒç´ 1**ï¼š
   - åˆ¤æ–­0æ˜¯å¦å­˜åœ¨ â†’ ä¸å­˜åœ¨
   - æ‰€ä»¥1æ˜¯åºåˆ—èµ·ç‚¹
   - ä»1å¼€å§‹å‘åæŸ¥æ‰¾ï¼š
     - 1 â†’ å­˜åœ¨2
     - 2 â†’ å­˜åœ¨3
     - 3 â†’ å­˜åœ¨4
     - 4 â†’ æ— åç»­å…ƒç´ 
   - åºåˆ—é•¿åº¦ï¼š4 ([1,2,3,4])

5. **æ£€æŸ¥å…ƒç´ 3**ï¼š
   - åˆ¤æ–­2æ˜¯å¦å­˜åœ¨ â†’ å­˜åœ¨
   - æ‰€ä»¥3ä¸æ˜¯åºåˆ—èµ·ç‚¹ï¼Œè·³è¿‡

6. **æ£€æŸ¥å…ƒç´ 2**ï¼š
   - åˆ¤æ–­1æ˜¯å¦å­˜åœ¨ â†’ å­˜åœ¨
   - æ‰€ä»¥2ä¸æ˜¯åºåˆ—èµ·ç‚¹ï¼Œè·³è¿‡

#### æ­¥éª¤3ï¼šå¾—å‡ºç»“æœ
æ¯”è¾ƒæ‰€æœ‰åºåˆ—é•¿åº¦ï¼Œæœ€é•¿çš„åºåˆ—æ˜¯[1,2,3,4]ï¼Œé•¿åº¦ä¸º4ã€‚

#### ç®—æ³•ä¼˜åŒ–ç‚¹

1. **é¿å…é‡å¤è®¡ç®—**ï¼šåªä»åºåˆ—èµ·ç‚¹å¼€å§‹æŸ¥æ‰¾ï¼Œé¿å…äº†å¯¹[2,3,4]ã€[3,4]ç­‰å­åºåˆ—çš„é‡å¤è®¡ç®—
2. **é«˜æ•ˆæŸ¥æ‰¾**ï¼šä½¿ç”¨å“ˆå¸Œè¡¨å®ç°O(1)æ—¶é—´å¤æ‚åº¦çš„å…ƒç´ æŸ¥æ‰¾
3. **çº¿æ€§æ—¶é—´å¤æ‚åº¦**ï¼šè™½ç„¶æœ‰åµŒå¥—å¾ªç¯ï¼Œä½†æ¯ä¸ªå…ƒç´ æœ€å¤šè¢«è®¿é—®ä¸¤æ¬¡ï¼Œæ€»ä½“æ—¶é—´å¤æ‚åº¦ä¸ºO(n)

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç®—æ³•èƒ½å¤Ÿåœ¨çº¿æ€§æ—¶é—´å†…æ‰¾å‡ºæœ€é•¿è¿ç»­åºåˆ—ï¼Œè€Œä¸éœ€è¦å…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚
</details>
