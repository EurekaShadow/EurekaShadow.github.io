---
slug: VercelBlog
title: 将 Docusaurus 网站部署到 Vercel 
authors: eurekaX
tags: [Vercel]
---

import CardImg from '@site/src/components/CardImg';


<!-- truncate -->

## 碎碎念🥱

为了实现 [git pages](https://eurekashadow.github.io/ )网站的**流畅访问**，我曾尝试了各种方法：

1. 尝试用 `cloudflare`的 CDN 进行加速，一番折腾之后，加了一个寂寞，故放弃 `cloudflare` 方案；

2. 尝试用 `阿里云 OSS + CDN`的方式进行加速，未遂。原因是 OSS 服务需要域名备案，而域名备案需要ESC(云服务器)，得花钱买，没钱且暂时没精力去折腾什么服务器；

3. 尝试用 `七牛云` 的**免费** `OSS + CDN` 进行加速，依旧未遂，还是域名备案问题；

4. 尝试将网站部署到 `Gitee` 的 `Gitee pages`上，以实现加速，但兴致冲冲将代码推送到 `Gitee` 之后发现，Gitee pages **似乎下线了**。😑 

以上问题对于有相关背景的程序员来说，也许根本不算什么，分分钟就解决了。但我只是个新手，完全小白，做这个网站完全是兴趣使然，就当图一乐吧。🤣

## 为什么选择 Vercel？

主要原因依旧是部署到 git pages 上的网站在国内访问**实在是太慢了**，想换成 Vercel 看看能不能快一点，结果网站的部署异常的顺利！虽然不见得有多快，但部署实在是省心省力，我开始有点喜欢Vercel了，想写个博客总结一下。在这篇文章中，我将记录将 Docusaurus 网站部署到 Vercel 的主要过程。

### 准备工作：
如果之前已经学会将 `Docusaurus` 网站部署到 `git pages` 上，那么 `Vercel部署` 自然就显得简单许多，可以说是易如反掌。反之，则起码需要满足下列三个要求：
1. 能够构建 [Docusaurus](https://www.docusaurus.cn/docs "官方参考文档") 项目；
2. 能够将与网站相关的代码[推送](https://blog.csdn.net/jiunian_2761/article/details/122907766 "参考")到 [github](https://github.com/) ；
3. 已购买域名；

:::danger[特别提醒]

如果没自己域名需要“梯子”才能访问部署成功的网站！自定义域名后方可解决该问题！

:::

完成以上准备工作后，网站的文件内容大致是这样的：

<p><CardImg src="/img/Blog/DocAndGit.jpg" alt="内容" isCenter={true} /></p>

如果使用的是 `SSH` 可以进行连接性测试：
```bash title="bash"
ssh -T git@github.com
```
预期结果大概是：
<p><CardImg src="/img/Blog/SSHTest.jpg" alt="测试结果" isCenter={true} /></p>

如果用的是https方式，就用不了上面的测试命令了，但只要 `git push`能够成功便可。另外，对于**仓库的名称**，可以**不用**是 `username.github.io`，普通名称的公开仓库应该也可以
（没试过，但我推断大概率可以）


## Vercel 部署步骤

### 第一步：注册并连接 GitHub

打开 [Vercel 官网](https://vercel.com/ )，注册账号（最好 continue with github）。

已安装的Vercel：

<p><CardImg src="/img/Blog/Vercelinstall.jpg" alt="已安装Vercel" isCenter={true} /></p>

权限设置：

<p><CardImg src="/img/Blog/VercelPer.jpg" alt="Permission" isCenter={true} /></p>

### 第二步：导入项目

引入包含 Docusaurus 项目的仓库：

<p><CardImg src="/img/Blog/GithubRepoImport.jpg" alt="import" isCenter={true} /></p>

Vercel 会自动检测项目类型并配置构建设置，直接点击部署：

<p><CardImg src="/img/Blog/VercelDeploy.jpg" alt="Deploy" isCenter={true} /></p>

### 第三步：访问部署结果

部署成功后大致是这样的：

<p><CardImg src="/img/Blog/VercelDomain.jpg" alt="Deploy" isCenter={true} /></p>

如果有梯子的话，点击 Vercel 给出的域名就可以访问已经成功部署的网站了。

## 域名配置

### 为什么需要自定义域名

没梯子无法访问默认域名，需要配置自定义域名后方可正常访问。

### 添加自定义域名

添加域名：

<p><CardImg src="/img/Blog/VercelAddDomain.jpg" alt="AddDomain" isCenter={true} /></p>

在此处添加域名后，需要返回域名的购买平台 `修改DNS` 以及 `添加记录` 。我用的是阿里云：

修改DNS：

<p><CardImg src="/img/Blog/VercelDNSModify.jpg" alt="ModifyDNS" isCenter={true} /></p>

添加记录：

<p><CardImg src="/img/Blog/AliyunAddRe.jpg" alt="添加记录" isCenter={true} /></p>

上面关于域名验证这记录可能不够详尽，主要是因为我没截图，再回去弄一遍太麻烦。反正大概率是给自己看的，缺几步应该没问题。

配置完毕后是这样的：

<p><CardImg src="/img/Blog/VercelDomainVerified.jpg" alt="DomainVerified" isCenter={true} /></p>

## 自动化部署

大功告成！现在可以通过自己的域名访问部署到 Vercel 上的网站了，而且不需要梯子！之后对博客内容进行更新后，想要再进行部署时，git push 成功之后，Vercel会识别到仓库代码的变换然后自动进行部署了！没错，只需：
```bash title="bash"
git add .
git commit -m "commit message"
git push
```

此外，我还添加了 `Speed insights` 和 `Web analytics` 功能，按照 Vercel 提供的[教程](https://vercel.com/docs/speed-insights ) 进行操作即可，没啥难度。
唯一有点让人感到困惑的可能是第三步。以下是第三步的参考代码：
```js title="src/theme/Root.js"
import React from 'react';
// highlight-start
import { SpeedInsights } from '@vercel/speed-insights/react';
import { Analytics } from '@vercel/analytics/react';
// highlight-end

function Root({ children }) {
  return (
    <>
      {children}
	  // highlight-start
      <SpeedInsights />
	  <Analytics />
	  // highlight-end
    </>
  );
}

export default Root;
```

















