<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">为 Docusaurus 添加 Algolia 搜索功能 | 我的网站</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://eurekashadow.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://eurekashadow.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://eurekashadow.github.io/blog/Algolia"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="为 Docusaurus 添加 Algolia 搜索功能 | 我的网站"><meta data-rh="true" name="description" content="本文介绍使用 Algolia 为 Docusaurus 网站添加搜索功能。"><meta data-rh="true" property="og:description" content="本文介绍使用 Algolia 为 Docusaurus 网站添加搜索功能。"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-08-27T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/EurekaShadow"><meta data-rh="true" property="article:tag" content="Algolia,Search,搜索"><link data-rh="true" rel="icon" href="/img/Eureka.ico"><link data-rh="true" rel="canonical" href="https://eurekashadow.github.io/blog/Algolia"><link data-rh="true" rel="alternate" href="https://eurekashadow.github.io/blog/Algolia" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://eurekashadow.github.io/en/blog/Algolia" hreflang="en"><link data-rh="true" rel="alternate" href="https://eurekashadow.github.io/blog/Algolia" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AFEW9ZLEC6-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://eurekashadow.github.io/blog/Algolia","mainEntityOfPage":"https://eurekashadow.github.io/blog/Algolia","url":"https://eurekashadow.github.io/blog/Algolia","headline":"为 Docusaurus 添加 Algolia 搜索功能","name":"为 Docusaurus 添加 Algolia 搜索功能","description":"本文介绍使用 Algolia 为 Docusaurus 网站添加搜索功能。","datePublished":"2025-08-27T00:00:00.000Z","dateModified":"2025-09-10T08:14:58.000Z","author":{"@type":"Person","name":"Eureka X","description":"Mr.Nobody","url":"https://github.com/EurekaShadow","image":"https://github.com/EurekaShadow.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://eurekashadow.github.io/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="我的网站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="我的网站 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="我的网站" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.8b36c2e1.css">
<script src="/assets/js/runtime~main.de277b3c.js" defer="defer"></script>
<script src="/assets/js/main.b8a7161f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/Eureka.svg"><link rel="preload" as="image" href="https://github.com/EurekaShadow.png"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Eureka.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Eureka.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">我的网站</b></a><a class="navbar__item navbar__link" href="/docs/reflection-space">记录</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/blog/Algolia" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li><li><a href="/en/blog/Algolia" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li></ul></div><a href="https://github.com/EurekaShadow/EurekaShadow.github.io/tree/master" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LeetCode20">有效的括号</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LeetCode452">用最小数量的箭引爆气球</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LeetCode57">插入区间</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LeetCode56">合并区间</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/LeetCode228">汇总区间</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">为 Docusaurus 添加 Algolia 搜索功能</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-08-27T00:00:00.000Z">2025年8月27日</time> · <!-- -->阅读需 14 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/blog/authors/all-Eureka-X-articles"><img class="avatar__photo authorImage_XqGP" src="https://github.com/EurekaShadow.png" alt="Eureka X"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="/blog/authors/all-Eureka-X-articles"><span class="authorName_yefp">Eureka X</span></a></div><small class="authorTitle_nd0D" title="Mr.Nobody">Mr.Nobody</small><div class="authorSocials_rSDt"><a href="https://github.com/EurekaShadow" target="_blank" rel="noopener noreferrer" class="authorSocialLink_owbf" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_owbf githubSvg_Uu4N"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>本文介绍使用 Algolia 为 Docusaurus 网站添加搜索功能。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-配置-algolia-教程-"><span class="B2_JnYG"> 配置 Algolia 教程 🔎</span><a href="#-配置-algolia-教程-" class="hash-link" aria-label="-配置-algolia-教程-的直接链接" title="-配置-algolia-教程-的直接链接">​</a></h2>
<p>我参考了这篇<a href="https://www.alanwang.site/posts/blog-guides/docusaurus-search" target="_blank" rel="noopener noreferrer">文章</a>为我的网站添加了搜索功能。但是在实践过程中遇到了一些问题，原文章说明也不够详细，因此决定写一篇更加详细的博客来记录整个配置过程。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="获取-algolia-api">获取 Algolia API<a href="#获取-algolia-api" class="hash-link" aria-label="获取 Algolia API的直接链接" title="获取 Algolia API的直接链接">​</a></h2>
<p>本小节的目标是获取 <code>Algolia</code> 的这三个 <code>API</code>：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. Application ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Search API Key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Admin API Key</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-名称对应关系">API 名称对应关系<a href="#api-名称对应关系" class="hash-link" aria-label="API 名称对应关系的直接链接" title="API 名称对应关系的直接链接">​</a></h3>
<p><code>Algolia</code>中 的 <code>API</code> 名称和代码中的名称并<strong>不完全一致</strong>，对应关系如下：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">docusaurus.config.js</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Application</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ID</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> appId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Search</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">API</span><span class="token plain"> </span><span class="token maybe-class-name">Key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> apiKey</span><br></span></code></pre></div></div>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Actions secrets</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Application</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ID</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ALGOLIA_APP_ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Admin</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">API</span><span class="token plain"> </span><span class="token maybe-class-name">Key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ALGOLIA_API_KEY</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="注册-algolia-账户">注册 Algolia 账户<a href="#注册-algolia-账户" class="hash-link" aria-label="注册 Algolia 账户的直接链接" title="注册 Algolia 账户的直接链接">​</a></h3>
<ol>
<li>打开 <a href="https://www.algolia.com/" target="_blank" rel="noopener noreferrer" title="Algolia">Algolia官网</a> ，使用Github账号注册并登录</li>
</ol>
<p></p>
<ol start="2">
<li>点击 <code>Not now ...</code> 跳过初始设置</li>
</ol>
<p></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="获取-api">获取 API<a href="#获取-api" class="hash-link" aria-label="获取 API的直接链接" title="获取 API的直接链接">​</a></h3>
<ol>
<li>打开 <code>Settings</code> 配置页面</li>
</ol>
<p></p>
<ol start="2">
<li>查看API Key</li>
</ol>
<p></p>
<p></p>
<p>上面三个 <code>API</code> 即为所需，此页面可保持打开，方便后续复制粘贴。 至此，三个 <code>API</code> 应已成功获取。</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>重要提醒</div><div class="admonitionContent_BuS1"><p>不要分享 <strong>Admin API Key！</strong> 这是敏感信息，泄露可能导致安全问题。！</p></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>只找到两个 API ?</summary><div><div class="collapsibleContent_i85q"><p>如果在查看 <code>API</code> 的时候看到<strong>只有两个</strong> <code>API</code>，分别是 <code>Application ID</code> 和 <code>Search API Key</code>，没有 <code>Admin API Key</code> ？！那说明刚才没有严格按照这个<a href="/blog/Algolia#%E6%B3%A8%E5%86%8C-algolia-%E8%B4%A6%E6%88%B7">步骤</a>走，现在看到的是<code>Algolia</code> 默认创建的 Application <code>Docsearch</code> 。该 Application 暂时是没有 <code>Admin API Key</code> 密钥的。（按官方的教程一步步走应该会有，但我没试过。🥱）解决方法是再创建一个 Application，在这里：<code>Settings/API Keys</code></p><p></p><p>填上名称后，其他配置保持默认，直接点击 <code>Next:Review &amp; Confirm</code> -&gt; <code>Create Application</code>。新Application 的 <code>API</code> 获取方式与上面一样。</p></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建-actions-secrets">创建 Actions Secrets<a href="#创建-actions-secrets" class="hash-link" aria-label="创建 Actions Secrets的直接链接" title="创建 Actions Secrets的直接链接">​</a></h2>
<ol>
<li>打开存放网站项目代码的 Github 仓库，进入：<code>Settings/Secrets and variables/Actions</code>。</li>
</ol>
<p></p>
<ol start="2">
<li>返回 Algolia 页面，复制 <code>Application ID</code>：</li>
</ol>
<p></p>
<ol start="3">
<li>返回 Github 页面，填上名称 <code>ALGOLIA_APP_ID</code>，粘贴秘钥，点击 <code>Add secret</code>。</li>
</ol>
<p></p>
<ol start="4">
<li>返回 Algolia 页面，复制 <code>Admin API Key</code>：</li>
</ol>
<p></p>
<ol start="5">
<li>返回 Github 页面，填上名称 <code>ALGOLIA_API_KEY</code>，粘贴秘钥，点击 <code>Add secret</code>。</li>
</ol>
<p></p>
<ol start="6">
<li>预期结果：</li>
</ol>
<p></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建-github-actions-workflow">创建 Github Actions workflow<a href="#创建-github-actions-workflow" class="hash-link" aria-label="创建 Github Actions workflow的直接链接" title="创建 Github Actions workflow的直接链接">​</a></h2>
<ul>
<li>可以在本地项目根目录下创建 <code>.github/workflows/docsearch.yml</code> 文件：</li>
</ul>
<p></p>
<p>以下将提供两个 <code>docsearch.yml</code> 配置，分别为原始版本和改进版本。</p>
<p>这是两个版本的对比：</p>
<p><strong>原始版本</strong>：从参考资料的<a href="https://www.alanwang.site/posts/blog-guides/docusaurus-search#%E5%88%9B%E5%BB%BA-github-actions" target="_blank" rel="noopener noreferrer">文章</a>中复制修改，功能基础。</p>
<p><strong>改进版本</strong>：解决实际问题而生——网站有100+记录但只爬取到16条且显示成功。</p>
<p>改进版本新增功能：</p>
<ul>
<li>输出详细错误信息</li>
<li>爬取记录过少时工作流失败并提示</li>
</ul>
<p><strong>配置要点</strong>：根据网站实际记录数调整<strong>高亮行</strong>配置，如网站约100条则配置为100，后续可随内容变化调整。如不知道自己的网站记录具体有多少条，可以先值改低一点，比如改为1，这样即使只爬取到一条记录，也会显示执行成功，这时候已经得到具体的记录数了，再修改为具体记录数相近的数值。</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">改进</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">原始</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">.github/workflows/docsearch.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DocSearch Scraper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">workflow_dispatch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">schedule</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cron</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0 0 * * *&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">algolia</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Install jq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sudo apt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">get install jq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Validate docsearch.json exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          if [ ! -f &quot;docsearch.json&quot; ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            echo &quot;docsearch.json not found!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Get the content of docsearch.json as config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> algolia_config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> echo &quot;config=$(cat docsearch.json </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> jq </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">r tostring)&quot; </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"> $GITHUB_OUTPUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run algolia/docsearch</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scraper image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">ALGOLIA_APP_ID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.ALGOLIA_APP_ID </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">ALGOLIA_API_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.ALGOLIA_API_KEY </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">CONFIG</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> steps.algolia_config.outputs.config </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo &quot;Starting DocSearch scraper...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          # 捕获输出并检查退出码</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          docker run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            --env APPLICATION_ID=${ALGOLIA_APP_ID} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            --env API_KEY=${ALGOLIA_API_KEY} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            --env &quot;CONFIG=${CONFIG}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            algolia/docsearch-scraper &gt; scraper_output.log 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo &quot;DocSearch scraper execution finished.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Validate scraping results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          # 显示完整的抓取日志（便于调试）</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo &quot;=== SCRAPER OUTPUT ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          cat scraper_output.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo &quot;=== END OUTPUT ===&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># 检查是否有错误信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          if grep </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">q &quot;ERROR\</span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain">Exception\</span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain">Traceback&quot; scraper_output.log; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">echo &quot;ERROR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Scraper encountered errors during execution&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># 提取抓取的记录数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          hits=$(grep &quot;Nb hits</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">&quot; scraper_output.log </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> awk &#x27;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">print $3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          if </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">z &quot;$hits&quot; </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">echo &quot;ERROR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Could not determine number of hits&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">echo &quot;Records scraped</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $hits&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># 验证记录数量是否合理</span><span class="token plain"></span><br></span><span class="token-line code-block-highlighted-line" style="color:#393A34"><span class="token plain">          if </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> &quot;$hits&quot; </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lt 100 </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">; then</span><br></span><span class="token-line code-block-highlighted-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">echo &quot;ERROR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Insufficient records scraped ($hits &lt; 100). This indicates incomplete scraping.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          fi</span><br></span><span class="token-line code-block-highlighted-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">echo &quot;SUCCESS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Adequate records scraped ($hits </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain">= 100)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Archive scraper logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/upload</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">artifact@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">if</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> scraper</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">logs</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> github.run_id </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> github.run_attempt </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> scraper_output.log</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">.github/workflows/docsearch.yml</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DocSearch Scraper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定义工作流触发条件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 允许手动触发工作流</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">workflow_dispatch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 自动运行 (UTC时间)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">schedule</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cron</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0 0 * * *&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定义工作流任务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">algolia</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 运行环境</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 检出代码仓库</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 安装 jq 工具用于处理 JSON</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Install jq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sudo apt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">get install jq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 验证配置文件是否存在</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Validate docsearch.json exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          if [ ! -f &quot;docsearch.json&quot; ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            echo &quot;docsearch.json not found!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 读取并设置 Algolia 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Get the content of docsearch.json as config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> algolia_config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> echo &quot;config=$(cat docsearch.json </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> jq </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">r tostring)&quot; </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"> $GITHUB_OUTPUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 运行 DocSearch 爬虫</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run algolia/docsearch</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scraper image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># 从 secrets 获取 Algolia 凭据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">ALGOLIA_APP_ID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.ALGOLIA_APP_ID </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">ALGOLIA_API_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.ALGOLIA_API_KEY </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">CONFIG</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> steps.algolia_config.outputs.config </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo &quot;Starting DocSearch scraper...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          docker run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            --env APPLICATION_ID=${ALGOLIA_APP_ID} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            --env API_KEY=${ALGOLIA_API_KEY} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            --env &quot;CONFIG=${CONFIG}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            algolia/docsearch-scraper</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo &quot;DocSearch scraper completed successfully.&quot;</span><br></span></code></pre></div></div></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>两个版本的详细比对</summary><div><div class="collapsibleContent_i85q"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="功能完整性对比">功能完整性对比<a href="#功能完整性对比" class="hash-link" aria-label="功能完整性对比的直接链接" title="功能完整性对比的直接链接">​</a></h4><p><strong>1. 错误检测和验证机制</strong></p><p><strong>原始版本（较差）：</strong></p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  echo &quot;Starting DocSearch scraper...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  docker run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    --env APPLICATION_ID=${ALGOLIA_APP_ID} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    --env API_KEY=${ALGOLIA_API_KEY} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    --env &quot;CONFIG=${CONFIG}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    algolia/docsearch-scraper</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  echo &quot;DocSearch scraper completed successfully.&quot;  # 总是显示成功</span><br></span></code></pre></div></div><p><strong>改进版本（较好）：</strong></p><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Validate scraping results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    # 完整的验证机制</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    # 1. 显示完整日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    cat scraper_output.log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 2. 错误检测</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if grep </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">q &quot;ERROR</span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain">Exception</span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain">Traceback&quot; scraper_output.log; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">echo &quot;ERROR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Scraper encountered errors&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 3. 结果数量验证</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> &quot;$hits&quot; </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">lt 100 </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">echo &quot;ERROR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Insufficient records&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fi</span><br></span></code></pre></div></div><p><strong>2. 日志记录和调试能力</strong></p><p><strong>原始版本缺陷：</strong></p><ul>
<li>没有捕获详细输出</li>
<li>遇到问题时难以诊断</li>
<li>无法查看实际执行过程</li>
</ul><p><strong>改进版本优势：</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 捕获完整输出用于分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run ... &gt; scraper_output.log 2&gt;&amp;1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 显示完整日志便于调试</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;=== SCRAPER OUTPUT ===&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat scraper_output.log</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="具体改进点分析">具体改进点分析<a href="#具体改进点分析" class="hash-link" aria-label="具体改进点分析的直接链接" title="具体改进点分析的直接链接">​</a></h4><p><strong>1. 真实成功验证</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本问题：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 只要程序运行完成就显示成功</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 无法区分&quot;运行完成&quot;和&quot;成功完成&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 16条记录也会显示成功</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本优势：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 检查实际抓取的记录数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 验证是否达到预期标准</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 只有真正成功才标记为成功</span><br></span></code></pre></div></div><p><strong>2. 错误处理机制</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本问题：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 没有错误检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 静默失败无法发现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 网络问题或配置错误无法识别</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本优势：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 自动检测错误信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 关键词匹配发现异常</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 及时终止并报告错误</span><br></span></code></pre></div></div><p><strong>3. 调试和监控能力</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本限制：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 无日志记录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 无法回溯问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 难以优化性能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本功能：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 完整日志捕获</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 日志归档保存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 便于问题分析和性能优化</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="实际场景对比">实际场景对比<a href="#实际场景对比" class="hash-link" aria-label="实际场景对比的直接链接" title="实际场景对比的直接链接">​</a></h4><p><strong>场景1：网络连接问题</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 只抓取了16条记录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 工作流显示&quot;成功&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 你不知道有问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 只抓取了16条记录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- hits &lt; 100，工作流失败</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 通过日志可以发现问题原因</span><br></span></code></pre></div></div><p><strong>场景2：配置文件错误</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 程序异常退出但仍可能显示成功</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 无法定位配置问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本结果：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 捕获错误日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- grep 检测到 &quot;ERROR&quot; 关键词</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 工作流正确失败并提示错误</span><br></span></code></pre></div></div><p><strong>场景3：正常运行</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 显示成功但信息有限</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 显示详细的执行过程</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 验证记录数量充足</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 保存完整日志供后续分析</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="可靠性和维护性">可靠性和维护性<a href="#可靠性和维护性" class="hash-link" aria-label="可靠性和维护性的直接链接" title="可靠性和维护性的直接链接">​</a></h4><p><strong>1. 监控能力</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 盲目信任执行结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 无法主动发现问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 主动验证执行质量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 设置合理的阈值标准</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 及早发现潜在问题</span><br></span></code></pre></div></div><p><strong>2. 故障排查</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 出问题时需要手动检查</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 缺乏诊断信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 自动化的错误检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 完整的日志记录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 快速定位问题根源</span><br></span></code></pre></div></div><p><strong>3. 持续改进</strong></p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原始版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 难以收集运行数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 无法优化性能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">改进版本：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 积累历史执行日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 分析性能趋势</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 持续优化工作流</span><br></span></code></pre></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h4><p>改进后的版本在以下方面明显优于原始版本：</p><ol>
<li><strong>准确性</strong>：从表面成功到真实成功验证</li>
<li><strong>可靠性</strong>：完善的错误检测和处理机制</li>
<li><strong>可维护性</strong>：详细的日志记录和分析能力</li>
<li><strong>监控性</strong>：主动的健康检查和预警机制</li>
<li><strong>透明度</strong>：完整的执行过程可视化</li>
</ol></div></div></details>
<p>如果想配置成<strong>部署完成后</strong>便触发该工作流，可以参考这篇<a href="https://www.alanwang.site/posts/blog-guides/docusaurus-search#%E5%88%9B%E5%BB%BA-github-actions" target="_blank" rel="noopener noreferrer">文章</a>。但我觉得手动和定时触发已经完全足够，因此没有尝试其他触发方式。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建-docsearchjson">创建 docsearch.json<a href="#创建-docsearchjson" class="hash-link" aria-label="创建 docsearch.json的直接链接" title="创建 docsearch.json的直接链接">​</a></h2>
<p></p>
<p>下面黄色高亮部分需要改成自己的配置，<code>index_name</code>可自定义，但要和后续的<code>docusaurus.config.js</code>配置一致，<code>start_urls</code>和<code>sitemap_urls</code>改成自己的链接。</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">docsearch.json</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line code-block-highlighted-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;index_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test-site&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line code-block-highlighted-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;start_urls&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;https://eureka12138github.github.io/&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line code-block-highlighted-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;sitemap_urls&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;https://eureka12138github.github.io/sitemap.xml&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;js_render&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;js_wait&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;selectors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lvl0&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;selector&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(//ul[contains(@class,&#x27;menu__list&#x27;)]//a[contains(@class, &#x27;menu__link menu__link--sublist menu__link--active&#x27;)]/text() | //nav[contains(@class, &#x27;navbar&#x27;)]//a[contains(@class, &#x27;navbar__link--active&#x27;)]/text())[last()]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;xpath&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;global&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;default_value&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Documentation&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lvl1&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;header h1, article h1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lvl2&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;article h2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lvl3&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;article h3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lvl4&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;article h4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lvl5&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;article h5, article td:first-child&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lvl6&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;article h6&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;text&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;article p, article li, article td:last-child&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;custom_settings&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;attributesForFaceting&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lang&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;language&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;version&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;docusaurus_tag&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;attributesToRetrieve&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;hierarchy&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;anchor&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;url&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;url_without_anchor&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;attributesToHighlight&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;hierarchy&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;attributesToSnippet&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;content:10&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;camelCaseAttributes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;hierarchy&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;searchableAttributes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;unordered(hierarchy.lvl0)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;unordered(hierarchy.lvl1)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;unordered(hierarchy.lvl2)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;unordered(hierarchy.lvl3)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;unordered(hierarchy.lvl4)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;unordered(hierarchy.lvl5)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;unordered(hierarchy.lvl6)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;distinct&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;attributeForDistinct&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;url&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;customRanking&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;desc(weight.pageRank)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;desc(weight.level)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;asc(weight.position)&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;ranking&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;words&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;filters&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;typo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;attribute&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;proximity&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;exact&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;custom&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;highlightPreTag&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;span class=&#x27;algolia-docsearch-suggestion--highlight&#x27;&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;highlightPostTag&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;/span&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;minWordSizefor1Typo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;minWordSizefor2Typos&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;allowTyposOnNumericTokens&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;minProximity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;ignorePlurals&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;advancedSyntax&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;attributeCriteriaComputedByMinProximity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;removeWordsIfNoResults&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;allOptional&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;separatorsToIndex&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;_&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;synonyms&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;js&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;javascript&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ts&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;typescript&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<blockquote>
<p>注意：绿色标注的两行配置（<code>js_render</code> 和 <code>js_wait</code>）<strong>非常重要</strong>。没有这两句的话，Algolia可能只能爬取到网站首页的数据。在除首页外的页面点击F12，可能会发现404页面，但此时网页是可以正常显示的。这种显示和源码不一致的情况导致无法爬取到完整数据。加上这两句表示渲染完成后再爬取，如此便能正常获取所有数据。</p>
</blockquote>
<blockquote>
<p>如果后续增加 <code>i18n</code> 国际化配置，想要爬取多语言数据，则需要修改<code>docsearch.json</code>中的 <code>sitemap_urls</code>。以英文站为例：</p>
</blockquote>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;sitemap_urls&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;https://eureka12138github.github.io/sitemap.xml&quot;,</span><br></span><span class="token-line code-block-add-line" style="color:#393A34"><span class="token plain">  &quot;https://eureka12138github.github.io/en/sitemap.xml&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">],</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置-docusaurusconfigjs">配置 docusaurus.config.js<a href="#配置-docusaurusconfigjs" class="hash-link" aria-label="配置 docusaurus.config.js的直接链接" title="配置 docusaurus.config.js的直接链接">​</a></h2>
<ol>
<li>位置示意：</li>
</ol>
<p></p>
<ol start="2">
<li>新增代码：</li>
</ol>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">docusaurus.config.js</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//添加Algolia搜索</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">algolia</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Application ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">appId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;********&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//  Search API Key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">apiKey</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*******************&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">indexName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test-site&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token comment" style="color:#999988;font-style:italic">//与docsearch.json中的index_name一致</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">searchPagePath</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;search&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">contextualSearch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div>
<p><a href="/blog/Algolia#api-%E5%90%8D%E7%A7%B0%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB">不记得名称对应关系？</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="网站部署">网站部署<a href="#网站部署" class="hash-link" aria-label="网站部署的直接链接" title="网站部署的直接链接">​</a></h2>
<p>将代码 <code>git push</code> 到远端仓库中。</p>
<p></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="手动触发工作流爬取信息">手动触发工作流爬取信息<a href="#手动触发工作流爬取信息" class="hash-link" aria-label="手动触发工作流爬取信息的直接链接" title="手动触发工作流爬取信息的直接链接">​</a></h2>
<p>在GitHub对应仓库中，点击 <code>Actions</code>，选择<code>Docsearch scraper</code>，点击<code>Run workflow</code>，即可触发该工作流，爬取网站信息并生成<strong>索引文件</strong>用于后续Algolia搜索。</p>
<p></p>
<p>运行完毕：</p>
<p></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="查看-algolia-记录">查看 Algolia 记录<a href="#查看-algolia-记录" class="hash-link" aria-label="查看 Algolia 记录的直接链接" title="查看 Algolia 记录的直接链接">​</a></h2>
<ol>
<li>点击 <code>Data Source</code></li>
</ol>
<p></p>
<ol start="2">
<li>点击 <code>indices</code>，从下图可知索引文件已经生成，在索引 <code>test-site</code> 下一共找到了 <code>134</code>个记录。这个记录数量取决于网站内容，如果内容多，记录也多。我这个只是演示网站，只有134记录，正常的索引记录可能会有几千甚至上万个。</li>
</ol>
<p></p>
<blockquote>
<p>注意，只有这里出现了和你<strong>网站内容所匹配的记录</strong>时，才表示<strong>配置成功</strong>。如果网站内容很多，结果这里的记录只有寥寥几条，那明显是某个地方出错了。可能是<a href="/blog/Algolia#%E5%88%9B%E5%BB%BA-docsearchjson">这里</a>的两行没有加？</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="将网站部署到gitpages">将网站部署到GitPages<a href="#将网站部署到gitpages" class="hash-link" aria-label="将网站部署到GitPages的直接链接" title="将网站部署到GitPages的直接链接">​</a></h2>
<blockquote>
<p>其实在本地就可以查看结果了，部署再看是为了进一步确认结果是否正确。毕竟有的时候本地运行的好好的，但是部署到GitPages的时候，就出现了问题。（说的就是你！i18n，坑爹的现在闪烁问题还没能解决。。。😑）</p>
</blockquote>
<p></p>
<p>部署完成：</p>
<p></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="结果">结果<a href="#结果" class="hash-link" aria-label="结果的直接链接" title="结果的直接链接">​</a></h2>
<p>大功告成！现在<a href="https://eureka12138github.github.io/" target="_blank" rel="noopener noreferrer" title="测试网站">网站</a>可以使用搜索功能了！🎉</p>
<p></p>
<p>这个过程还挺曲折的，多亏了下面的参考资料，没有他的文章参考，我怕是难以完成这个搜索功能。但即使有参考，也并非一蹴而就的，为了实现这个搜索功能，我花了很多时间，也走了很多弯路，希望这个总结能帮助到有缘之人。（也可能是未来的自己？🥱）</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-参考资料">📚 参考资料<a href="#-参考资料" class="hash-link" aria-label="📚 参考资料的直接链接" title="📚 参考资料的直接链接">​</a></h2>
<p>[1]. <a href="https://www.alanwang.site/posts/blog-guides/docusaurus-search" target="_blank" rel="noopener noreferrer" title="学习">AlanWang&#x27;s Blog</a></p><div class="blog-post-comments" style="margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--ifm-color-emphasis-300)"><div style="margin-top:2rem"><div style="min-height:200px">加载评论中...</div></div></div></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="关于 Algolia 搜索的配置" class="tag_zVej tagRegular_sFm0" href="/blog/tags/Algolia">Algolia</a></li><li class="tag_QGVx"><a rel="tag" title="关于 Search 功能的配置" class="tag_zVej tagRegular_sFm0" href="/blog/tags/Search">Search</a></li><li class="tag_QGVx"><a rel="tag" title="关于 搜索 功能的配置" class="tag_zVej tagRegular_sFm0" href="/blog/tags/搜索">搜索</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/EurekaShadow/EurekaShadow.github.io/tree/master/blog/2025-08-27-Algolia.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2025-09-10T08:14:58.000Z" itemprop="dateModified">2025年9月10日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/LeetCode54"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">螺旋矩阵</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/i18n"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">国际化</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-配置-algolia-教程-" class="table-of-contents__link toc-highlight"><b2>配置 Algolia 教程 🔎</b2></a></li><li><a href="#获取-algolia-api" class="table-of-contents__link toc-highlight">获取 Algolia API</a><ul><li><a href="#api-名称对应关系" class="table-of-contents__link toc-highlight">API 名称对应关系</a></li><li><a href="#注册-algolia-账户" class="table-of-contents__link toc-highlight">注册 Algolia 账户</a></li><li><a href="#获取-api" class="table-of-contents__link toc-highlight">获取 API</a></li></ul></li><li><a href="#创建-actions-secrets" class="table-of-contents__link toc-highlight">创建 Actions Secrets</a></li><li><a href="#创建-github-actions-workflow" class="table-of-contents__link toc-highlight">创建 Github Actions workflow</a></li><li><a href="#创建-docsearchjson" class="table-of-contents__link toc-highlight">创建 docsearch.json</a></li><li><a href="#配置-docusaurusconfigjs" class="table-of-contents__link toc-highlight">配置 docusaurus.config.js</a></li><li><a href="#网站部署" class="table-of-contents__link toc-highlight">网站部署</a></li><li><a href="#手动触发工作流爬取信息" class="table-of-contents__link toc-highlight">手动触发工作流爬取信息</a></li><li><a href="#查看-algolia-记录" class="table-of-contents__link toc-highlight">查看 Algolia 记录</a></li><li><a href="#将网站部署到gitpages" class="table-of-contents__link toc-highlight">将网站部署到GitPages</a></li><li><a href="#结果" class="table-of-contents__link toc-highlight">结果</a></li><li><a href="#-参考资料" class="table-of-contents__link toc-highlight">📚 参考资料</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">记录</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/mydoc/testpage0">模板</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">社交媒体</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://space.bilibili.com/283665748" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bilibili<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/EurekaShadow" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>