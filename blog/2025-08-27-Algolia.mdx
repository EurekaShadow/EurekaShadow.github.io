---
slug: Algolia
title: ä¸º Docusaurus æ·»åŠ  Algolia æœç´¢åŠŸèƒ½
authors: eurekaX
tags: [Algolia,Search,æœç´¢]
---

import { Highlight, Keyword, Light, B1, B2, B3, BH3, B3W, MyColor} from '@site/src/components/ForMDX';
import CardImg from '@site/src/components/CardImg';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

æœ¬æ–‡ä»‹ç»ä½¿ç”¨ Algolia ä¸º Docusaurus ç½‘ç«™æ·»åŠ æœç´¢åŠŸèƒ½ã€‚

<!-- truncate -->


## <B2> é…ç½® Algolia æ•™ç¨‹ ğŸ”</B2>

æˆ‘å‚è€ƒäº†è¿™ç¯‡[æ–‡ç« ](https://www.alanwang.site/posts/blog-guides/docusaurus-search)ä¸ºæˆ‘çš„ç½‘ç«™æ·»åŠ äº†æœç´¢åŠŸèƒ½ã€‚ä½†æ˜¯åœ¨å®è·µè¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼ŒåŸæ–‡ç« è¯´æ˜ä¹Ÿä¸å¤Ÿè¯¦ç»†ï¼Œå› æ­¤å†³å®šå†™ä¸€ç¯‡æ›´åŠ è¯¦ç»†çš„åšå®¢æ¥è®°å½•æ•´ä¸ªé…ç½®è¿‡ç¨‹ã€‚


## è·å– Algolia API

æœ¬å°èŠ‚çš„ç›®æ ‡æ˜¯è·å– `Algolia` çš„è¿™ä¸‰ä¸ª `API`ï¼š
```
1. Application ID
2. Search API Key
3. Admin API Key
``` 
### API åç§°å¯¹åº”å…³ç³»
`Algolia`ä¸­ çš„ `API` åç§°å’Œä»£ç ä¸­çš„åç§°å¹¶**ä¸å®Œå…¨ä¸€è‡´**ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š
```js title="docusaurus.config.js"
Application ID -> appId
Search API Key -> apiKey
```
```js title="Actions secrets"
Application ID -> ALGOLIA_APP_ID
Admin API Key -> ALGOLIA_API_KEY
```


### æ³¨å†Œ Algolia è´¦æˆ·
1. æ‰“å¼€ [Algoliaå®˜ç½‘](https://www.algolia.com/ "Algolia") ï¼Œä½¿ç”¨Githubè´¦å·æ³¨å†Œå¹¶ç™»å½•
<p><CardImg src="/img/Blog/Algolia1.jpg" alt="Algolia1" isCenter={true} isBoxed={true} /></p>

2. ç‚¹å‡» `Not now ...` è·³è¿‡åˆå§‹è®¾ç½®
<p><CardImg src="/img/Blog/Algolia2.jpg" alt="Algolia2" isCenter={true} isBoxed={true} /></p>

### è·å– API
1. æ‰“å¼€ `Settings` é…ç½®é¡µé¢
<p><CardImg src="/img/Blog/Algolia3.jpg" alt="Algolia3" isCenter={true} isBoxed={true} /></p>

2. æŸ¥çœ‹API Key
<p><CardImg src="/img/Blog/Algolia4.jpg" alt="Algolia4" isCenter={true} isBoxed={true} /></p>

<p><CardImg src="/img/Blog/Algolia5.jpg" alt="Algolia5" isCenter={true} isBoxed={true} /></p>

ä¸Šé¢ä¸‰ä¸ª `API` å³ä¸ºæ‰€éœ€ï¼Œæ­¤é¡µé¢å¯ä¿æŒæ‰“å¼€ï¼Œæ–¹ä¾¿åç»­å¤åˆ¶ç²˜è´´ã€‚ è‡³æ­¤ï¼Œä¸‰ä¸ª `API` åº”å·²æˆåŠŸè·å–ã€‚
:::danger[é‡è¦æé†’]
ä¸è¦åˆ†äº« **Admin API Keyï¼** è¿™æ˜¯æ•æ„Ÿä¿¡æ¯ï¼Œæ³„éœ²å¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ï¼
:::

<details>
<summary>åªæ‰¾åˆ°ä¸¤ä¸ª API ?</summary>

å¦‚æœåœ¨æŸ¥çœ‹ `API` çš„æ—¶å€™çœ‹åˆ°**åªæœ‰ä¸¤ä¸ª** `API`ï¼Œåˆ†åˆ«æ˜¯ `Application ID` å’Œ `Search API Key`ï¼Œæ²¡æœ‰ `Admin API Key` ï¼Ÿï¼é‚£è¯´æ˜åˆšæ‰æ²¡æœ‰ä¸¥æ ¼æŒ‰ç…§è¿™ä¸ª[æ­¥éª¤](./Algolia#æ³¨å†Œ-algolia-è´¦æˆ· )èµ°ï¼Œç°åœ¨çœ‹åˆ°çš„æ˜¯`Algolia` é»˜è®¤åˆ›å»ºçš„ Application `Docsearch` ã€‚è¯¥ Application æš‚æ—¶æ˜¯æ²¡æœ‰å¯†é’¥çš„ã€‚ï¼ˆæŒ‰å®˜æ–¹çš„æ•™ç¨‹ä¸€æ­¥æ­¥èµ°åº”è¯¥ä¼šæœ‰ï¼Œä½†æˆ‘æ²¡è¯•è¿‡ã€‚ğŸ¥±ï¼‰è§£å†³æ–¹æ³•æ˜¯å†åˆ›å»ºä¸€ä¸ª Applicationï¼Œåœ¨è¿™é‡Œï¼š`Settings/API Keys`
<p><CardImg src="/img/Blog/Algolia26.jpg" alt="Algolia26" isCenter={true} isBoxed={true} /></p>

å¡«ä¸Šåç§°åï¼Œå…¶ä»–é…ç½®ä¿æŒé»˜è®¤ï¼Œç›´æ¥ç‚¹å‡» `Next:Review & Confirm` -> `Create Application`ã€‚æ–°Application çš„ `API` è·å–æ–¹å¼ä¸ä¸Šé¢ä¸€æ ·ã€‚

</details>

## åˆ›å»º Actions Secrets
1. æ‰“å¼€å­˜æ”¾ç½‘ç«™é¡¹ç›®ä»£ç çš„ Github ä»“åº“ï¼Œè¿›å…¥ï¼š`Settings/Secrets and variables/Actions`ã€‚

<p><CardImg src="/img/Blog/Algolia8.jpg" alt="Algolia8" isCenter={true} isBoxed={true} /></p>

2. è¿”å› Algolia é¡µé¢ï¼Œå¤åˆ¶ `Application ID`ï¼š
<p><CardImg src="/img/Blog/Algolia9.jpg" alt="Algolia9" isCenter={true} isBoxed={true} /></p>

3. è¿”å› Github é¡µé¢ï¼Œå¡«ä¸Šåç§° `ALGOLIA_APP_ID`ï¼Œç²˜è´´ç§˜é’¥ï¼Œç‚¹å‡» `Add secret`ã€‚
<p><CardImg src="/img/Blog/Algolia11.jpg" alt="Algolia10" isCenter={true} isBoxed={true} /></p>

4. è¿”å› Algolia é¡µé¢ï¼Œå¤åˆ¶ `Admin API Key`ï¼š
<p><CardImg src="/img/Blog/Algolia12.jpg" alt="Algolia11" isCenter={true} isBoxed={true} /></p>

5. è¿”å› Github é¡µé¢ï¼Œå¡«ä¸Šåç§° `ALGOLIA_API_KEY`ï¼Œç²˜è´´ç§˜é’¥ï¼Œç‚¹å‡» `Add secret`ã€‚
<p><CardImg src="/img/Blog/Algolia13.jpg" alt="Algolia12" isCenter={true} isBoxed={true} /></p>

6. é¢„æœŸç»“æœï¼š
<p><CardImg src="/img/Blog/Algolia14.jpg" alt="Algolia14" isCenter={true} isBoxed={true} /></p>

## åˆ›å»º Github Actions workflow
* å¯ä»¥åœ¨æœ¬åœ°é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º `.github/workflows/docsearch.yml` æ–‡ä»¶ï¼š
<p><CardImg src="/img/Blog/Algolia6.jpg" alt="Algolia6" isCenter={true} isBoxed={true} /></p>

```yml title=".github/workflows/docsearch.yml"
name: DocSearch Scraper

# å®šä¹‰å·¥ä½œæµè§¦å‘æ¡ä»¶
on:
  # å…è®¸æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ
  workflow_dispatch:
  # è‡ªåŠ¨è¿è¡Œ (UTCæ—¶é—´)
  schedule:
    - cron: '0 0 * * *'

# å®šä¹‰å·¥ä½œæµä»»åŠ¡
jobs:
  algolia:
    # è¿è¡Œç¯å¢ƒ
    runs-on: ubuntu-latest
    steps:
      # æ£€å‡ºä»£ç ä»“åº“
      - uses: actions/checkout@v3

      # å®‰è£… jq å·¥å…·ç”¨äºå¤„ç† JSON
      - name: Install jq
        run: sudo apt-get install jq

      # éªŒè¯é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
      - name: Validate docsearch.json exists
        run: |
          if [ ! -f "docsearch.json" ]; then
            echo "docsearch.json not found!"
            exit 1
          fi

      # è¯»å–å¹¶è®¾ç½® Algolia é…ç½®
      - name: Get the content of docsearch.json as config
        id: algolia_config
        run: echo "config=$(cat docsearch.json | jq -r tostring)" >> $GITHUB_OUTPUT

      # è¿è¡Œ DocSearch çˆ¬è™«
      - name: Run algolia/docsearch-scraper image
        env:
          # ä» secrets è·å– Algolia å‡­æ®
          ALGOLIA_APP_ID: ${{ secrets.ALGOLIA_APP_ID }}
          ALGOLIA_API_KEY: ${{ secrets.ALGOLIA_API_KEY }}
          CONFIG: ${{ steps.algolia_config.outputs.config }}
        run: |
          echo "Starting DocSearch scraper..."
          docker run \
            --env APPLICATION_ID=${ALGOLIA_APP_ID} \
            --env API_KEY=${ALGOLIA_API_KEY} \
            --env "CONFIG=${CONFIG}" \
            algolia/docsearch-scraper
          echo "DocSearch scraper completed successfully."
```

å¦‚æœæƒ³é…ç½®æˆ**éƒ¨ç½²å®Œæˆå**ä¾¿è§¦å‘è¯¥å·¥ä½œæµï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡[æ–‡ç« ](https://www.alanwang.site/posts/blog-guides/docusaurus-search#%E5%88%9B%E5%BB%BA-github-actions )ã€‚ä½†æˆ‘è§‰å¾—æ‰‹åŠ¨å’Œå®šæ—¶è§¦å‘å·²ç»å®Œå…¨è¶³å¤Ÿï¼Œå› æ­¤æ²¡æœ‰å°è¯•å…¶ä»–è§¦å‘æ–¹å¼ã€‚

## åˆ›å»º docsearch.json

<p><CardImg src="/img/Blog/Algolia15.jpg" alt="Algolia15" isCenter={true} isBoxed={true} /></p>

ä¸‹é¢é»„è‰²é«˜äº®éƒ¨åˆ†éœ€è¦æ”¹æˆè‡ªå·±çš„é…ç½®ï¼Œ`index_name`å¯è‡ªå®šä¹‰ï¼Œä½†è¦å’Œåç»­çš„`docusaurus.config.js`é…ç½®ä¸€è‡´ï¼Œ`start_urls`å’Œ`sitemap_urls`æ”¹æˆè‡ªå·±çš„é“¾æ¥ã€‚
```json title="docsearch.json"
{
   // highlight-start
  "index_name": "test-site",
  "start_urls": ["https://www.eurekashadow.xin/"],
  "sitemap_urls": ["https://www.eurekashadow.xin/sitemap.xml"],
  // highlight-end
  // highlight-add-start
  "js_render": true,
  "js_wait": 1,
  // highlight-add-end
  "selectors": {
    "lvl0": {
      "selector": "(//ul[contains(@class,'menu__list')]//a[contains(@class, 'menu__link menu__link--sublist menu__link--active')]/text() | //nav[contains(@class, 'navbar')]//a[contains(@class, 'navbar__link--active')]/text())[last()]",
      "type": "xpath",
      "global": true,
      "default_value": "Documentation"
    },
    "lvl1": "header h1, article h1",
    "lvl2": "article h2",
    "lvl3": "article h3",
    "lvl4": "article h4",
    "lvl5": "article h5, article td:first-child",
    "lvl6": "article h6",
    "text": "article p, article li, article td:last-child"
  },
  "custom_settings": {
    "attributesForFaceting": ["type", "lang", "language", "version", "docusaurus_tag"],
    "attributesToRetrieve": ["hierarchy", "content", "anchor", "url", "url_without_anchor", "type"],
    "attributesToHighlight": ["hierarchy", "content"],
    "attributesToSnippet": ["content:10"],
    "camelCaseAttributes": ["hierarchy", "content"],
    "searchableAttributes": [
      "unordered(hierarchy.lvl0)",
      "unordered(hierarchy.lvl1)",
      "unordered(hierarchy.lvl2)",
      "unordered(hierarchy.lvl3)",
      "unordered(hierarchy.lvl4)",
      "unordered(hierarchy.lvl5)",
      "unordered(hierarchy.lvl6)",
      "content"
    ],
    "distinct": true,
    "attributeForDistinct": "url",
    "customRanking": ["desc(weight.pageRank)", "desc(weight.level)", "asc(weight.position)"],
    "ranking": ["words", "filters", "typo", "attribute", "proximity", "exact", "custom"],
    "highlightPreTag": "<span class='algolia-docsearch-suggestion--highlight'>",
    "highlightPostTag": "</span>",
    "minWordSizefor1Typo": 3,
    "minWordSizefor2Typos": 7,
    "allowTyposOnNumericTokens": false,
    "minProximity": 1,
    "ignorePlurals": true,
    "advancedSyntax": true,
    "attributeCriteriaComputedByMinProximity": true,
    "removeWordsIfNoResults": "allOptional",
    "separatorsToIndex": "_",
    "synonyms": [
      ["js", "javascript"],
      ["ts", "typescript"]
    ]
  }
}
```
> æ³¨æ„ï¼šç»¿è‰²æ ‡æ³¨çš„ä¸¤è¡Œé…ç½®ï¼ˆjs_render å’Œ js_waitï¼‰**éå¸¸é‡è¦**ã€‚æ²¡æœ‰è¿™ä¸¤å¥çš„è¯ï¼ŒAlgoliaå¯èƒ½åªèƒ½çˆ¬å–åˆ°ç½‘ç«™é¦–é¡µçš„æ•°æ®ã€‚åœ¨é™¤é¦–é¡µå¤–çš„é¡µé¢ç‚¹å‡»F12ï¼Œå¯èƒ½ä¼šå‘ç°404é¡µé¢ï¼Œä½†æ­¤æ—¶ç½‘é¡µæ˜¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºçš„ã€‚è¿™ç§æ˜¾ç¤ºå’Œæºç ä¸ä¸€è‡´çš„æƒ…å†µå¯¼è‡´æ— æ³•çˆ¬å–åˆ°å®Œæ•´æ•°æ®ã€‚åŠ ä¸Šè¿™ä¸¤å¥è¡¨ç¤ºæ¸²æŸ“å®Œæˆåå†çˆ¬å–ï¼Œå¦‚æ­¤ä¾¿èƒ½æ­£å¸¸è·å–æ‰€æœ‰æ•°æ®ã€‚


## é…ç½® docusaurus.config.js
1. ä½ç½®ç¤ºæ„ï¼š
<p><CardImg src="/img/Blog/Algolia16.jpg" alt="Algolia16" isCenter={true} isBoxed={true} /></p>

2. æ–°å¢ä»£ç ï¼š
```js title="docusaurus.config.js"
//æ·»åŠ Algoliaæœç´¢
algolia: {
    // Application ID
    appId: '********',
    //  Search API Key
    apiKey: '*******************',
    indexName: 'test-site',//ä¸docsearch.jsonä¸­çš„index_nameä¸€è‡´
    searchPagePath: 'search',
    contextualSearch: true
    },
```
[ä¸è®°å¾—åç§°å¯¹åº”å…³ç³»ï¼Ÿ](./Algolia#api-åç§°å¯¹åº”å…³ç³» )



## ç½‘ç«™éƒ¨ç½²
* å°†ä»£ç  `git push` åˆ°è¿œç«¯ä»“åº“ä¸­ã€‚
<p><CardImg src="/img/Blog/Algolia18.jpg" alt="Algolia18" isCenter={true} isBoxed={true} /></p>

## æ‰‹åŠ¨è§¦å‘å·¥ä½œæµçˆ¬å–ä¿¡æ¯

* åœ¨Verceléƒ¨ç½²å·²ç»å®Œæˆçš„æƒ…å†µä¸‹ï¼Œå›åˆ°GitHubä»“åº“ä¸­ï¼Œç‚¹å‡»Actionsï¼Œé€‰æ‹©Docsearch scraperï¼Œç‚¹å‡»Run workflowï¼Œå³å¯è§¦å‘è¯¥å·¥ä½œæµï¼Œçˆ¬å–ç½‘ç«™ä¿¡æ¯å¹¶ç”Ÿæˆç´¢å¼•æ–‡ä»¶ç”¨äºåç»­Algoliaæœç´¢ã€‚
<p><CardImg src="/img/Blog/Algolia19.jpg" alt="Algolia19" isCenter={true} isBoxed={true} /></p>

* è¿è¡Œå®Œæ¯•ï¼š
<p><CardImg src="/img/Blog/Algolia20.jpg" alt="Algolia20" isCenter={true} isBoxed={true} /></p>

## æŸ¥çœ‹ Algolia è®°å½•
1. ç‚¹å‡» `Data Source`
<p><CardImg src="/img/Blog/Algolia21.jpg" alt="Algolia21" isCenter={true} isBoxed={true} /></p>

2. ç‚¹å‡» `indices`ï¼Œä»ä¸‹å›¾å¯çŸ¥ç´¢å¼•æ–‡ä»¶å·²ç»ç”Ÿæˆï¼Œåœ¨ç´¢å¼• `test-site` ä¸‹ä¸€å…±æ‰¾åˆ°äº† `134`ä¸ªè®°å½•ã€‚è¿™ä¸ªè®°å½•æ•°é‡å–å†³äºç½‘ç«™å†…å®¹ï¼Œå¦‚æœå†…å®¹å¤šï¼Œè®°å½•ä¹Ÿå¤šã€‚æˆ‘è¿™ä¸ªåªæ˜¯æ¼”ç¤ºç½‘ç«™ï¼Œåªæœ‰134è®°å½•ï¼Œæ­£å¸¸çš„ç´¢å¼•è®°å½•å¯èƒ½ä¼šæœ‰å‡ åƒç”šè‡³ä¸Šä¸‡ä¸ªã€‚

> æ³¨æ„ï¼Œåªæœ‰è¿™é‡Œå‡ºç°äº†å’Œä½ **ç½‘ç«™å†…å®¹æ‰€åŒ¹é…çš„è®°å½•**æ—¶ï¼Œæ‰è¡¨ç¤º**é…ç½®æˆåŠŸ**ã€‚å¦‚æœç½‘ç«™å†…å®¹å¾ˆå¤šï¼Œç»“æœè¿™é‡Œçš„è®°å½•åªæœ‰å¯¥å¯¥å‡ æ¡ï¼Œé‚£æ˜æ˜¾æ˜¯æŸä¸ªåœ°æ–¹å‡ºé”™äº†ã€‚å¯èƒ½æ˜¯[è¿™é‡Œ](./Algolia#åˆ›å»º-docsearchjson)çš„ä¸¤è¡Œæ²¡æœ‰åŠ ï¼Ÿ
<p><CardImg src="/img/Blog/Algolia22.jpg" alt="Algolia22" isCenter={true} isBoxed={true} /></p>

## å°†ç½‘ç«™éƒ¨ç½²åˆ°GitPages
> å…¶å®åœ¨æœ¬åœ°å°±å¯ä»¥æŸ¥çœ‹ç»“æœäº†ï¼Œéƒ¨ç½²å†çœ‹æ˜¯ä¸ºäº†è¿›ä¸€æ­¥ç¡®è®¤ç»“æœæ˜¯å¦æ­£ç¡®ã€‚æ¯•ç«Ÿæœ‰çš„æ—¶å€™æœ¬åœ°è¿è¡Œçš„å¥½å¥½çš„ï¼Œä½†æ˜¯éƒ¨ç½²åˆ°GitPagesçš„æ—¶å€™ï¼Œå°±å‡ºç°äº†é—®é¢˜ã€‚ï¼ˆè¯´çš„å°±æ˜¯ä½ ï¼i18nï¼Œå‘çˆ¹çš„ç°åœ¨é—ªçƒé—®é¢˜è¿˜æ²¡èƒ½è§£å†³ã€‚ã€‚ã€‚ğŸ˜‘ï¼‰
<p><CardImg src="/img/Blog/Algolia23.jpg" alt="Algolia23" isCenter={true} isBoxed={true} /></p>

* éƒ¨ç½²å®Œæˆï¼š
<p><CardImg src="/img/Blog/Algolia24.jpg" alt="Algolia24" isCenter={true} isBoxed={true} /></p>

## ç»“æœ
å¤§åŠŸå‘Šæˆï¼ç°åœ¨ç½‘ç«™å¯ä»¥ä½¿ç”¨æœç´¢åŠŸèƒ½äº†ï¼ğŸ‰
<p><CardImg src="/img/Gif/gif-example.gif" alt="AlgoliaResult" isCenter={true} isBoxed={true} /></p>

è¿™ä¸ªè¿‡ç¨‹è¿˜æŒºæ›²æŠ˜çš„ï¼Œå¤šäºäº†ä¸‹é¢çš„å‚è€ƒèµ„æ–™ï¼Œæ²¡æœ‰ä»–çš„æ–‡ç« å‚è€ƒï¼Œæˆ‘æ€•æ˜¯éš¾ä»¥å®Œæˆè¿™ä¸ªæœç´¢åŠŸèƒ½ã€‚ä½†å³ä½¿æœ‰å‚è€ƒï¼Œä¹Ÿå¹¶éä¸€è¹´è€Œå°±çš„ï¼Œä¸ºäº†å®ç°è¿™ä¸ªæœç´¢åŠŸèƒ½ï¼Œæˆ‘èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œä¹Ÿèµ°äº†å¾ˆå¤šå¼¯è·¯ï¼Œå¸Œæœ›è¿™ä¸ªæ€»ç»“èƒ½å¸®åŠ©åˆ°æœ‰ç¼˜ä¹‹äººã€‚ï¼ˆä¹Ÿå¯èƒ½æ˜¯æœªæ¥çš„è‡ªå·±ï¼ŸğŸ¥±ï¼‰

## ğŸ“š å‚è€ƒèµ„æ–™

[1]. [AlanWang's Blog](https://www.alanwang.site/posts/blog-guides/docusaurus-search "å­¦ä¹ ")

